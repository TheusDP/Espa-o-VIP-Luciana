<html>
<head>
    <title>Agendamento</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="../Styles/Styles_Calendario.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="Menu Precos.html"><i class="fas fa-chevron-left"></i> Voltar</a>
        </div>
        <div class="title">Selecione uma data e horário</div>
        <div class="subtitle">Horário Padrão de Brasília (BRT)</div>
        <div class="calendar">
            <div class="month-year">
                <i class="fas fa-chevron-left" onclick="changeMonth(-1)"></i>
                <span id="month-year">Outubro 2024</span>
                <i class="fas fa-chevron-right" onclick="changeMonth(1)"></i>
            </div>
        </div>
        <table class="calendar-table">
            <thead>
                <tr>
                    <th>dom.</th>
                    <th>seg.</th>
                    <th>ter.</th>
                    <th>qua.</th>
                    <th>qui.</th>
                    <th>sex.</th>
                    <th>sáb.</th>
                </tr>
            </thead>
            <tbody id="calendar-body">
                <!-- Calendar days will be generated by JavaScript -->
            </tbody>
        </table>
        <div class="time-selection">
            
            <p>Apenas algumas sessões ainda estão disponíveis para agendamento. Os agendamentos serão encerrados 1 minuto antes da sessão iniciar.</p>
            <div class="time-buttons">
                <button class="disabled">14:30</button>
                <button onclick="selectTime(this)">15:00</button>
                <button onclick="selectTime(this)">15:30</button>
                <button onclick="selectTime(this)">16:00</button>
                <button onclick="selectTime(this)">16:30</button>
            </div>
        </div>
        <div class="info">
            <p>Informações do agendamento</p>
            <p id="service-name"></p>
            <p id="service-duration-price"></p>
            <div id="additional-services"></div>
            <p id="service-address">Rua Sarandi, 22, Vila Bela</p>
        </div>
        <div class="footer">
            <button>Próximo</button>
        </div>
    </div>
    <script>
        const monthNames = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
        const dayNames = ["domingo", "segunda-feira", "terça-feira", "quarta-feira", "quinta-feira", "sexta-feira", "sábado"];
        let currentMonth = 9; // Outubro
        let currentYear = 2024;

        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            updateCalendar();
        }

        function updateCalendar() {
            document.getElementById("month-year").textContent = `${monthNames[currentMonth]} ${currentYear}`;
            generateCalendarDays(currentMonth, currentYear);
        }

        function generateCalendarDays(month, year) {
            const calendarBody = document.getElementById("calendar-body");
            calendarBody.innerHTML = "";
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            let date = 1;

            for (let i = 0; i < 6; i++) {
                const row = document.createElement("tr");

                for (let j = 0; j < 7; j++) {
                    const cell = document.createElement("td");
                    if (i === 0 && j < firstDay) {
                        cell.textContent = "";
                    } else if (date > daysInMonth) {
                        break;
                    } else {
                        const button = document.createElement("button");
                        button.textContent = date;
                        button.onclick = () => selectDate(button, date, month, year);
                        if (date === 1 && month === 9 && year === 2024) {
                            button.classList.add("selected");
                        }
                        cell.appendChild(button);
                        date++;
                    }
                    row.appendChild(cell);
                }
                calendarBody.appendChild(row);
            }
        }

        function selectDate(button, date, month, year) {
            const selectedButton = document.querySelector(".calendar-table button.selected");
            if (selectedButton) {
                selectedButton.classList.remove("selected");
            }
            button.classList.add("selected");
            const selectedDate = new Date(year, month, date);
            document.getElementById("selected-date").textContent = `${dayNames[selectedDate.getDay()]}, ${date} de ${monthNames[month]} de ${year}`;
        }

        function selectTime(button) {
            const selectedTimeButton = document.querySelector(".time-buttons button.selected");
            if (selectedTimeButton) {
                selectedTimeButton.classList.remove("selected");
            }
            button.classList.add("selected");
        }

        document.addEventListener("DOMContentLoaded", () => {
            updateCalendar();
        });
        const urlParams = new URLSearchParams(window.location.search);
    const serviceName = urlParams.get('serviceName');
    const serviceTime = urlParams.get('serviceTime');
    const servicePrice = urlParams.get('servicePrice');

    if (serviceName && serviceTime && servicePrice) {
        document.getElementById('service-name').textContent = serviceName;
        document.getElementById('service-address').textContent = `Rua Sarandi, 22, Vila Bela`;
    }
    document.addEventListener("DOMContentLoaded", () => {
        updateCalendar();

        // Lê os dados do agendamento do LocalStorage
        const serviceName = localStorage.getItem('serviceName');
        const serviceDurationPrice = localStorage.getItem('serviceDurationPrice');
        const additionalServices = JSON.parse(localStorage.getItem('additionalServices'));

        // Exibe os dados do agendamento na página do calendário
        if (serviceName && serviceDurationPrice) {
            document.getElementById('service-name').textContent = serviceName;
            document.getElementById('service-duration-price').textContent = serviceDurationPrice;

            // Exibe os serviços adicionais
            if (additionalServices) {
                additionalServices.forEach(service => {
                    const serviceBox = document.createElement('div');
                    serviceBox.innerHTML = `
                        <p>${service.name}</p>
                        <p>${service.details}</p>
                    `;
                    document.getElementById('additional-services').appendChild(serviceBox);
                });
            }
        }
    });
    function selectDate(button, date, month, year) {
  const selectedButton = document.querySelector(".calendar-table button.selected");
  if (selectedButton) {
    selectedButton.classList.remove("selected");
  }
  button.classList.add("selected");
  const selectedDate = new Date(year, month, date);
  document.getElementById("selected-date").textContent = `${dayNames[selectedDate.getDay()]}, ${date} de ${monthNames[month]} de ${year}`;

  // Altera as informações do dia e mês abaixo do calendário
  document.getElementById("selected-date").textContent = `${dayNames[selectedDate.getDay()]}, ${date} de ${monthNames[month]} de ${year}`;
  document.getElementById("selected-month").textContent = `${monthNames[month]}`;
  document.getElementById("selected-year").textContent = `${year}`;
}
    </script>
</body>
</html>